<ng-container *ngIf="pedido; else loading">
  <h2>Pedido #{{pedido.id}}</h2>
  <div>
    <h3>Acompanhamento do pedido</h3>
    <ul>
      @for(status of pedido.historicoStatus; track status){
        <li>{{formatDate(status.data!, "dd/MM/yyyy, hh:mm:ss a", "pt-BR")}} - {{formatStatus(status.status!)}}</li>
      }
    </ul>
  </div>
  <div>
    <h3>Items do Pedido</h3>
    <table [dataSource]="items" mat-table>
      <ng-container matColumnDef="nome">
        <th *matHeaderCellDef mat-header-cell> Nome</th>
        <td *matCellDef="let element"
            mat-cell> {{ element.produto.nome }} {{ isPizza(element.produto) ? formatTamanhoPizza(element.produto.tamanhoPizza) : formatarMl(element.produto.ml) }}
        </td>
      </ng-container>
      <ng-container matColumnDef="quantidade">
        <th *matHeaderCellDef mat-header-cell> Quantidade</th>
        <td *matCellDef="let element" mat-cell> {{ element.quantidade }}</td>
      </ng-container>
      <ng-container matColumnDef="precoUnit">
        <th *matHeaderCellDef mat-header-cell> Preço Unitário</th>
        <td *matCellDef="let element" mat-cell> R${{ parseFloat(element.produto.preco).toFixed(2) }}</td>
      </ng-container>
      <ng-container matColumnDef="precoTotal">
        <th *matHeaderCellDef mat-header-cell> Preço Total</th>
        <td *matCellDef="let element" mat-cell>
          R${{ (parseFloat(element.produto.preco) * element.quantidade).toFixed(2) }}
        </td>
      </ng-container>
      <tr *matHeaderRowDef="displayedColumns" mat-header-row></tr>
      <tr *matRowDef="let row; columns: displayedColumns;" mat-row></tr>
    </table>
  </div>
  <div>
    <h3>Total: R${{pedido.total.toFixed(2)}}</h3>
  </div>
  <div>
    <h3>Forma de pagamento: {{formatFormaPagamento(pedido.formaPagamento)}}</h3>
  </div>
  <div *ngIf="pedido.cupom">
    <h3>Cupom Utilizado: {{pedido.cupom}}</h3>
  </div>
  <div>
    <h3>Endereço para entrega:</h3><p>{{pedido.endereco!.logradouro}}, {{pedido.endereco!.bairro}}, {{pedido.endereco!.cidade}}, {{pedido.endereco!.cep}}</p>
  </div>
</ng-container>
<ng-template #loading>
  <mat-spinner></mat-spinner>
</ng-template>
